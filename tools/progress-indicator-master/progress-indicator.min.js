!function(){function t(){this.__events={}}function e(t){this.options=s.extend({},this.constructor.defaultOptions,t),this.handlers={},this.init()}for(var n="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global||this||{},i=0,o=["webkit","moz"],r=0;r<o.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[o[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[o[r]+"CancelAnimationFrame"]||window[o[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var n=(new Date).getTime(),o=Math.max(0,16.7-(n-i)),r=window.setTimeout(function(){t(n+o)},o);return i=n+o,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)});var s={extend:function(t){for(var e=1,n=arguments.length;e<n;e++)for(var i in arguments[e])arguments[e].hasOwnProperty(i)&&(t[i]=arguments[e][i]);return t},getViewPortSizeHeight:function(){var t=window;if(null!=t.innerWidth)return t.innerHeight;var e=t.document;return"CSS1Compat"==document.compatMode?e.documentElement.clientHeight:e.body.clientHeight},getScrollOffsetsTop:function(){var t=window;if(null!=t.pageXOffset)return t.pageYOffset;var e=t.document;return"CSS1Compat"==document.compatMode?e.documentElement.scrollTop:e.body.scrollTop},addEvent:function(t,e,n){if(document.addEventListener)return t.addEventListener(e,n,!1),n;if(document.attachEvent){var i=function(){return n.apply(t,arguments)};return t.attachEvent("on"+e,i),i}},isValidListener:function(t){return"function"==typeof t||!(!t||"object"!=typeof t)&&s.isValidListener(t.listener)},indexOf:function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=-1,i=0,o=t.length;i<o;i++)if(t[i]===e){n=i;break}return n}};t.prototype.on=function(t,e){if(t&&e){if(!s.isValidListener(e))throw new TypeError("listener must be a function");var n=this.__events,i=n[t]=n[t]||[],o="object"==typeof e;return-1===s.indexOf(i,e)&&i.push(o?e:{listener:e,once:!1}),this}},t.prototype.once=function(t,e){return this.on(t,{listener:e,once:!0})},t.prototype.off=function(t,e){var n=this.__events[t];if(n){for(var i,o=0,r=n.length;o<r;o++)if(n[o]&&n[o].listener===e){i=o;break}return void 0!==i&&n.splice(i,1,null),this}},t.prototype.emit=function(t,e){var n=this.__events[t];if(n){for(var i=0;i<n.length;i++){var o=n[i];o&&(o.listener.apply(this,e||[]),o.once&&this.off(t,o.listener))}return this}},e.VERSION="1.0.0",e.defaultOptions={color:"#0A74DA"};var a=e.prototype=new t;a.constructor=e,a.init=function(){this.createIndicator();var t=this.calculateWidthPrecent();this.setWidth(t),this.bindScrollEvent()},a.createIndicator=function(){var t=document.createElement("div");t.id="progress-indicator",t.className="progress-indicator",t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.height="3px",t.style.backgroundColor=this.options.color,this.element=t,document.body.appendChild(t)},a.calculateWidthPrecent=function(){this.docHeight=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight),this.viewPortHeight=s.getViewPortSizeHeight(),this.sHeight=Math.max(this.docHeight-this.viewPortHeight,0);var t=s.getScrollOffsetsTop();return this.sHeight?t/this.sHeight:0},a.setWidth=function(t){this.element.style.width=100*t+"%"},a.bindScrollEvent=function(){var t,e=this;s.addEvent(window,"scroll",function(){window.requestAnimationFrame(function(){var n=Math.min(s.getScrollOffsetsTop()/e.sHeight,1);n!=t&&(t&&1==n&&e.emit("end"),t=n,e.setWidth(n))})})},"undefined"==typeof exports||exports.nodeType?n.ProgressIndicator=e:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=e),exports.ProgressIndicator=e)}();